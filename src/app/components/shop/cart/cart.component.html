<section class="cart-section">
    <div class="container cart-container">
        <!-- Professional Header -->
        <h1 class="cart-page-title">{{ 'Shopping Cart' | translate }}</h1>

        <div class="row g-xl-5 g-4" *ngIf="(cartItem$ | async)?.length">

            <!-- Left Side: Items List -->
            <div class="col-xxl-9 col-xl-8">
                <div class="cart-items-wrapper">
                    <!-- Column Legend (Desktop) -->
                    <div class="cart-header">
                        <span>{{ 'Product' | translate }}</span>
                        <span>{{ 'Price' | translate }}</span>
                        <span>{{ 'Quantity' | translate }}</span>
                        <span>{{ 'Subtotal' | translate }}</span>
                    </div>

                    <div class="cart-item" *ngFor="let item of cartItem$ | async">
                        <!-- Product Cluster -->
                        <div class="product-col">
                            <a [routerLink]="['/product/', item?.product?.slug]" class="img-link">
                                <img [src]="item?.variation && item?.variation?.variation_image
                                        ? item?.variation?.variation_image?.original_url
                                        : item?.product?.product_thumbnail
                                        ? item?.product?.product_thumbnail?.original_url
                                        : 'assets/images/product.png'" alt="product image">
                            </a>
                            <div class="info">
                                <h3 class="name">
                                    <a [routerLink]="['/product/', item.product.slug]">
                                        {{item?.variation ? item.variation.name : item?.product?.name}}
                                    </a>
                                </h3>
                                <div class="meta">
                                    <span *ngIf="item?.variation?.selected_variation">
                                        {{ item?.variation?.selected_variation }}
                                    </span>
                                    <span *ngIf="!item?.variation && item?.product?.unit">
                                        {{ 'Unit' | translate }}: {{ item.product.unit }}
                                    </span>
                                    <div class="discount-badge" *ngIf="item?.product?.discount">
                                        {{ 'Sale' | translate }}
                                    </div>
                                </div>
                                <!-- Actions Mobile + Desktop -->
                                <div class="actions-mobile">
                                    <button (click)="addToWishlist(item)" class="save">
                                        <i class="ri-heart-line"></i> {{ 'Wishlist' | translate }}
                                    </button>
                                    <button (click)="delete(item.id)" class="remove">
                                        <i class="ri-delete-bin-line"></i> {{ 'Remove' | translate }}
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Price -->
                        <div class="cell price-col" [attr.data-label]="'Price' | translate">
                            {{ (item?.variation ? item.variation.sale_price : (item?.product && item?.wholesale_price ?
                            item.wholesale_price : item?.product?.sale_price)) || 0 | currencySymbol }}
                            <del *ngIf="item?.product?.discount">
                                {{ (item?.variation ? item.variation.price : item?.product?.price) || 0 | currencySymbol
                                }}
                            </del>
                        </div>

                        <!-- Quantity Selector -->
                        <div class="cell qty-col" [attr.data-label]="'Quantity' | translate">
                            <div class="qty-box">
                                <button type="button" class="btn-q" (click)="updateQuantity(item, -1)"
                                    [class.delete-style]="(item?.quantity || 0) <= 1">
                                    <i
                                        [class]="(item?.quantity || 0) > 1 ? 'ri-subtract-line' : 'ri-delete-bin-line'"></i>
                                </button>
                                <input type="text" class="qty-input" [value]="item?.quantity" readonly>
                                <button type="button" class="btn-q" (click)="updateQuantity(item, 1)">
                                    <i class="ri-add-line"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Row Subtotal -->
                        <div class="cell total-col" [attr.data-label]="'Subtotal' | translate">
                            {{ ((item?.variation ? item.variation.sale_price : (item?.product && item?.wholesale_price ?
                            item.wholesale_price : item?.product?.sale_price)) || 0) * (item?.quantity || 0) |
                            currencySymbol }}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Side: Order Summary -->
            <div class="col-xxl-3 col-xl-4">
                <div class="order-summary-card">
                    <h2 class="summary-title">{{ 'Order Summary' | translate }}</h2>

                    <div class="rows">
                        <div class="row-item">
                            <span class="label">{{ 'Items Total' | translate }}</span>
                            <span class="value">{{ (cartTotal$ | async) || 0 | currencySymbol }}</span>
                        </div>
                        <div class="row-item" *ngIf="!(cartDigital$ | async)">
                            <span class="label">{{ 'Shipping' | translate }}</span>
                            <span class="value free">{{ 'Free' | translate }}</span>
                        </div>
                        <div class="row-item">
                            <span class="label">{{ 'Tax' | translate }}</span>
                            <span class="value">{{ 'Calculated at checkout' | translate }}</span>
                        </div>
                    </div>

                    <div class="total-row">
                        <span class="label">{{ 'Total' | translate }}</span>
                        <span class="value">{{ (cartTotal$ | async) || 0 | currencySymbol }}</span>
                    </div>

                    <a [routerLink]="['/checkout/']" class="checkout-btn">
                        {{ 'Checkout Now' | translate }}
                    </a>

                    <a [routerLink]="['/collections/']" class="back-link">
                        <i class="ri-arrow-left-line"></i> {{ 'Continue Shopping' | translate }}
                    </a>
                </div>
            </div>

        </div>

        <!-- Professional Empty State -->
        <app-no-data [class]="'no-data-added'" [image]="'assets/svg/empty-items.svg'" [text]="'Your cart is empty'"
            [description]="'Browse our latest collections and find your perfect style.'"
            *ngIf="!(cartItem$ | async)?.length">
        </app-no-data>
    </div>
</section>